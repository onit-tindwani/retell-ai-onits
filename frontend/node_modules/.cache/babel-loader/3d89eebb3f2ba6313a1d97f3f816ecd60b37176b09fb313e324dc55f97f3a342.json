{"ast":null,"code":"import _objectSpread from\"C:/Users/Admin/Desktop/Retell-AI-Onits/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const ActiveCall=()=>{const{callId}=useParams();const navigate=useNavigate();const[callStatus,setCallStatus]=useState({status:'connecting',duration:0,transcript:[]});useEffect(()=>{let timer;if(callStatus.status==='active'){timer=setInterval(()=>{setCallStatus(prev=>_objectSpread(_objectSpread({},prev),{},{duration:prev.duration+1}));},1000);}return()=>{if(timer){clearInterval(timer);}};},[callStatus.status]);const formatDuration=seconds=>{const minutes=Math.floor(seconds/60);const remainingSeconds=seconds%60;return\"\".concat(minutes,\":\").concat(remainingSeconds.toString().padStart(2,'0'));};const handleEndCall=async()=>{try{await fetch(\"/api/calls/\".concat(callId,\"/end\"),{method:'POST'});setCallStatus(prev=>_objectSpread(_objectSpread({},prev),{},{status:'ended'}));setTimeout(()=>{navigate('/history');},2000);}catch(error){console.error('Error ending call:',error);}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-3xl mx-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow sm:rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-5 sm:p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg leading-6 font-medium text-gray-900\",children:[callStatus.status==='connecting'&&'Connecting...',callStatus.status==='active'&&'Call in Progress',callStatus.status==='ended'&&'Call Ended']}),callStatus.status==='active'&&/*#__PURE__*/_jsxs(\"p\",{className:\"mt-2 text-sm text-gray-500\",children:[\"Duration: \",formatDuration(callStatus.duration)]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-4 h-64 overflow-y-auto\",children:callStatus.transcript.map((message,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-900\",children:message})},index))})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 flex justify-center\",children:callStatus.status==='active'&&/*#__PURE__*/_jsx(\"button\",{onClick:handleEndCall,className:\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\",children:\"End Call\"})})]})})})})});};export default ActiveCall;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","jsxs","_jsxs","jsx","_jsx","ActiveCall","callId","navigate","callStatus","setCallStatus","status","duration","transcript","timer","setInterval","prev","_objectSpread","clearInterval","formatDuration","seconds","minutes","Math","floor","remainingSeconds","concat","toString","padStart","handleEndCall","fetch","method","setTimeout","error","console","className","children","map","message","index","onClick"],"sources":["C:/Users/Admin/Desktop/Retell-AI-Onits/frontend/src/components/ActiveCall.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\n\r\ninterface CallStatus {\r\n  status: 'connecting' | 'active' | 'ended';\r\n  duration: number;\r\n  transcript: string[];\r\n}\r\n\r\nconst ActiveCall: React.FC = () => {\r\n  const { callId } = useParams<{ callId: string }>();\r\n  const navigate = useNavigate();\r\n  const [callStatus, setCallStatus] = useState<CallStatus>({\r\n    status: 'connecting',\r\n    duration: 0,\r\n    transcript: [],\r\n  });\r\n\r\n  useEffect(() => {\r\n    let timer: NodeJS.Timeout;\r\n    if (callStatus.status === 'active') {\r\n      timer = setInterval(() => {\r\n        setCallStatus((prev) => ({\r\n          ...prev,\r\n          duration: prev.duration + 1,\r\n        }));\r\n      }, 1000);\r\n    }\r\n\r\n    return () => {\r\n      if (timer) {\r\n        clearInterval(timer);\r\n      }\r\n    };\r\n  }, [callStatus.status]);\r\n\r\n  const formatDuration = (seconds: number): string => {\r\n    const minutes = Math.floor(seconds / 60);\r\n    const remainingSeconds = seconds % 60;\r\n    return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  const handleEndCall = async () => {\r\n    try {\r\n      await fetch(`/api/calls/${callId}/end`, {\r\n        method: 'POST',\r\n      });\r\n      setCallStatus((prev) => ({ ...prev, status: 'ended' }));\r\n      setTimeout(() => {\r\n        navigate('/history');\r\n      }, 2000);\r\n    } catch (error) {\r\n      console.error('Error ending call:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-100\">\r\n      <div className=\"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"max-w-3xl mx-auto\">\r\n          <div className=\"bg-white shadow sm:rounded-lg\">\r\n            <div className=\"px-4 py-5 sm:p-6\">\r\n              <div className=\"text-center\">\r\n                <h3 className=\"text-lg leading-6 font-medium text-gray-900\">\r\n                  {callStatus.status === 'connecting' && 'Connecting...'}\r\n                  {callStatus.status === 'active' && 'Call in Progress'}\r\n                  {callStatus.status === 'ended' && 'Call Ended'}\r\n                </h3>\r\n                {callStatus.status === 'active' && (\r\n                  <p className=\"mt-2 text-sm text-gray-500\">\r\n                    Duration: {formatDuration(callStatus.duration)}\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"mt-6\">\r\n                <div className=\"bg-gray-50 rounded-lg p-4 h-64 overflow-y-auto\">\r\n                  {callStatus.transcript.map((message, index) => (\r\n                    <div key={index} className=\"mb-2\">\r\n                      <p className=\"text-sm text-gray-900\">{message}</p>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"mt-6 flex justify-center\">\r\n                {callStatus.status === 'active' && (\r\n                  <button\r\n                    onClick={handleEndCall}\r\n                    className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\r\n                  >\r\n                    End Call\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ActiveCall; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}